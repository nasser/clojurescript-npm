#!/usr/bin/env node
const { realpathSync, readFileSync, writeFileSync } = require('fs')

const path = require('path')
const lib = path.join(path.dirname(realpathSync(__filename)), '../lib')

const { startREPL } = require(`${lib}/repl`)
const cljs = require(`${lib}/clojurescript`)

const argv = require('yargs').argv // yar!

const args = process.argv.slice(2)

if (argv.e) {
  let code = readFileSync(argv.e, 'utf8')
  cljs.eval(code)
} else if (argv.c && argv.o) {
  let code = readFileSync(argv.c, 'utf8')
  const compiledCode = cljs.compile(code)
  writeFileSync(argv.o, compiledCode)
  process.exit()
} else {
  startREPL()
}